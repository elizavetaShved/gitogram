import{C as D}from"./loader.0a707479.js";import{_ as p,o as t,c as n,a as r,t as h,p as N,b as S,E as L,g as F,r as c,d as O,e as g,n as y,F as x,f as I,h as m,i as l,j as P}from"./index.0907dd76.js";import{g as T,R as B}from"./repository-item.12c1efdd.js";const E={name:"owner-link",props:["owner"]},M=["href"],R=["src","alt"],V={class:"owner-link__name"};function U(e,s,o,a,_,i){return t(),n("a",{href:o.owner.htmlUrl,target:"_blank",class:"owner-link"},[r("img",{src:o.owner.avatarUrl,alt:o.owner.login,class:"owner-link__img"},null,8,R),r("div",V,h(o.owner.login),1)],8,M)}const A=p(E,[["render",U],["__scopeId","data-v-bbf3432e"]]),j={},z={width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},G=r("path",{d:"M3.2 5.74a.75.75 0 0 1 1.06-.04L8 9.227 11.74 5.7a.75.75 0 1 1 1.02 1.1l-4.25 4a.75.75 0 0 1-1.02 0l-4.25-4a.75.75 0 0 1-.04-1.06Z",fill:"#212121"},null,-1),H=[G];function Z(e,s){return t(),n("svg",z,H)}const q=p(j,[["render",Z]]);const J={name:"loader-skeleton"},K=e=>(N("data-v-1bb337a1"),e=e(),S(),e),Q={class:"skeleton skeleton--small"},W=K(()=>r("div",{class:"skeleton__strokes-wrapper"},[r("div",{class:"skeleton__item skeleton__item--width-middle"}),r("div",{class:"skeleton__item skeleton__item--width-big"}),r("div",{class:"skeleton__item skeleton__item--width-small"})],-1)),X=[W];function Y(e,s,o,a,_,i){return t(),n("div",Q,X)}const ee=p(J,[["render",Y],["__scopeId","data-v-1bb337a1"]]);const se={name:"issues-list",components:{LoaderSkeleton:ee,ErrorRest:L,IconArrow:q},props:["repo"],data(){return{isOpen:!1,issues:void 0,loading:!1,error:!1}},methods:{onClickToggler(){this.isOpen=!this.isOpen,this.issues||this.getIssues()},async getIssues(){this.loading=!0;const e=this.repo.owner.login,s=this.repo.name;F(e,s).then(o=>{this.issues=o}).catch(o=>{this.error=o}).finally(()=>{this.loading=!1})}},computed:{isNoData(){return this.issues&&!this.error&&!this.issues.length}}},te={class:"issues-list"},oe={class:"issues-list__issues-list"},ne=["href"],re={class:"issues-list__issues-text"},ie={key:2};function ae(e,s,o,a,_,i){const f=c("icon-arrow"),k=c("loader-skeleton"),w=c("error-rest");return t(),n("div",te,[r("button",{type:"button",class:"issues-list__toggler",onClick:s[0]||(s[0]=(...u)=>i.onClickToggler&&i.onClickToggler(...u))},[O(h(_.isOpen?"Hide issues":"View issues")+" ",1),g(f,{class:y(["issues-list__arrow",{"issues-list__arrow--show":_.isOpen}])},null,8,["class"])]),r("div",{class:y(["issues-list__issues-list-container",{"mod-show":_.isOpen}])},[r("ul",oe,[(t(!0),n(x,null,I(_.issues,(u,v)=>(t(),n("li",{key:v,class:"issues-list__issues-item"},[r("a",{href:u.user.htmlUrl,target:"_blank",class:"issues-list__issues-name-link"},h(u.user.login),9,ne),r("div",re,h(u.title),1)]))),128))]),_.loading?(t(),m(k,{key:0})):l("",!0),_.error?(t(),m(w,{key:1})):l("",!0),i.isNoData?(t(),n("div",ie,"No issues")):l("",!0)],2)])}const _e=p(se,[["render",ae],["__scopeId","data-v-0deb2c2b"]]);const ce={name:"c-date",props:["date"],methods:{parsDate(e){let s=new Date(e).getTime();return new Date(s).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}}},le={class:"date"};function de(e,s,o,a,_,i){return t(),n("div",le,h(i.parsDate(o.date)),1)}const ue=p(ce,[["render",de],["__scopeId","data-v-99563b99"]]),$=5,pe=P("favourites-repos",{state:()=>({favouritesList:[],isLastPage:!1,loading:!1,error:null,currentPage:1}),actions:{async getFavouritesList(){if(!this.isLastPage){this.loading=!0;const e=this.currentPage;try{const s=await T(e,$);if(s)this.currentPage++,this.favouritesList.push(...s),s.length<$&&(this.isLastPage=!0);else throw new Error}catch(s){this.error=s}finally{this.loading=!1}}}}});const he={name:"favourites-page",components:{IssuesList:_e,RepositoryItem:B,ErrorRest:L,CLoader:D,CDate:ue,OwnerLink:A},setup(){return{store:pe()}},mounted(){this.fetchMore()},methods:{fetchMore(){this.store.getFavouritesList()}},computed:{isNoData(){var e;return!this.store.loading&&!((e=this.store.favouritesList)!=null&&e.length)}}},me={class:"favourites-page"},ge={class:"page-content page-content--small"},fe={key:0,class:"favourites-page__list"},ke={key:1},we={key:4,class:"btn-more-wrapper"};function ve(e,s,o,a,_,i){var b;const f=c("owner-link"),k=c("repository-item"),w=c("issues-list"),u=c("c-date"),v=c("c-loader"),C=c("error-rest");return t(),n("main",me,[r("div",ge,[(b=a.store.favouritesList)!=null&&b.length?(t(),n("ul",fe,[(t(!0),n(x,null,I(a.store.favouritesList,d=>(t(),n("li",{key:d.id,class:"favourites-page__item-wrapper"},[g(f,{owner:d.owner},null,8,["owner"]),g(k,{repo:d},null,8,["repo"]),d.openIssuesCount?(t(),m(w,{key:0,repo:d},null,8,["repo"])):l("",!0),g(u,{date:d.createdAt},null,8,["date"])]))),128))])):l("",!0),i.isNoData?(t(),n("div",ke,"No data")):l("",!0),a.store.loading?(t(),m(v,{key:2,class:"loader-list"})):l("",!0),a.store.error?(t(),m(C,{key:3})):l("",!0),!a.store.isLastPage&&!a.store.loading?(t(),n("div",we,[r("button",{onClick:s[0]||(s[0]=(...d)=>i.fetchMore&&i.fetchMore(...d)),class:"btn btn--main btn--center-row"}," \u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0435\u0449\u0451 ")])):l("",!0)])])}const Le=p(he,[["render",ve],["__scopeId","data-v-eba5431d"]]);export{Le as default};
