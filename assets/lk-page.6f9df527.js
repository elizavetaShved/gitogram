import{R as A,s as C}from"./repository-item.12c1efdd.js";import{j as R,D as U,_ as v,E as I,r as d,o,c as i,a as s,t as _,F as w,f as N,e as P,i as c,h as f,p as L,b,H as x,J as M}from"./index.0907dd76.js";import{C as $}from"./loader.0a707479.js";const F=10,E=R("user-repos",{state:()=>({userReposList:[],isLastPage:!1,loading:!1,error:null,currentPage:1}),actions:{async getUserReposList(e){if(!this.isLastPage){this.loading=!0;const r=this.currentPage;try{const t=await U(e,r,F);if(t)this.currentPage++,this.userReposList.push(...t),t.length<F&&(this.isLastPage=!0);else throw new Error}catch(t){this.error=t}finally{this.loading=!1}}}}});const D={name:"repositories-list",props:["user"],components:{ErrorRest:I,CLoader:$,RepositoryItem:A},setup(){return{store:E()}},mounted(){this.store.userReposList.length||this.fetchMore()},methods:{fetchMore(){this.store.getUserReposList(this.user.login)},getShortenCountNumber(e){return C(e)}},computed:{isNoData(){var e;return!this.store.loading&&!((e=this.store.userReposList)!=null&&e.length)},isShowMore(){return!this.store.isLastPage&&!this.store.loading}}},B=e=>(L("data-v-bc78d586"),e=e(),b(),e),q={key:0,class:"repositories-list"},V={class:"title-wrapper"},O=B(()=>s("div",{class:"title"},"Repositories",-1)),T={class:"title-value"},j={key:0,class:"repositories-list__list"},H={key:1},J={key:4,class:"btn-more-wrapper"};function z(e,r,t,l,h,n){var p;const a=d("repository-item"),g=d("c-loader"),y=d("error-rest");return o(),i(w,null,[t.user?(o(),i("div",q,[s("div",V,[O,s("div",T,_(n.getShortenCountNumber(t.user.publicRepos)),1)]),(p=l.store.userReposList)!=null&&p.length?(o(),i("ul",j,[(o(!0),i(w,null,N(l.store.userReposList,u=>(o(),i("li",{key:u.id,class:"repositories-list__item-wrapper"},[P(a,{repo:u},null,8,["repo"])]))),128))])):c("",!0)])):c("",!0),n.isNoData?(o(),i("div",H,"No data")):c("",!0),l.store.loading?(o(),f(g,{key:2,class:"loader-list"})):c("",!0),l.store.error?(o(),f(y,{key:3})):c("",!0),n.isShowMore?(o(),i("div",J,[s("button",{onClick:r[0]||(r[0]=(...u)=>n.fetchMore&&n.fetchMore(...u)),class:"btn btn--main btn--center-row"}," \u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0435\u0449\u0451 ")])):c("",!0)],64)}const G=v(D,[["render",z],["__scopeId","data-v-bc78d586"]]),m={Repositories:"repositories",Following:"following"};const K={name:"user-info",props:["user"],emits:["changeContentActive"],data(){return{ContentName:m}},methods:{getShortenCountNumber(e){return C(e)},changeContentActive(e){this.$emit("changeContentActive",e)}}},k=e=>(L("data-v-48755fbc"),e=e(),b(),e),Q={key:0,class:"user"},W=k(()=>s("div",{class:"user__title title"},"My profile",-1)),X={class:"user__info-wrapper"},Y=["src","alt"],Z={class:"user__info"},ee={class:"user__info-nickname"},se={class:"user__info-follow-wrapper"},te={class:"user__info-follow-num"},oe=k(()=>s("span",{class:"user__info-follow-caption"},"reposts",-1)),re={class:"user__info-follow-num"},ne=k(()=>s("span",{class:"user__info-follow-caption"},"watchers",-1)),ie={key:0,class:"user__info-name"};function le(e,r,t,l,h,n){return t.user?(o(),i("div",Q,[W,s("div",X,[s("img",{src:t.user.avatarUrl,alt:t.user.login,class:"user__info-img"},null,8,Y),s("div",Z,[s("div",ee,_(t.user.login),1),s("div",se,[s("button",{class:"user__info-follow-item",onClick:r[0]||(r[0]=a=>n.changeContentActive(h.ContentName.Repositories))},[s("span",te,_(n.getShortenCountNumber(t.user.publicRepos)),1),oe]),s("button",{class:"user__info-follow-item",onClick:r[1]||(r[1]=a=>n.changeContentActive(h.ContentName.Following))},[s("span",re,_(n.getShortenCountNumber(t.user.followers)),1),ne])]),t.user.name?(o(),i("div",ie,_(t.user.name),1)):c("",!0)])])])):c("",!0)}const ce=v(K,[["render",le],["__scopeId","data-v-48755fbc"]]),S=10,ae=R("user-followers",{state:()=>({userFollowersList:[],isLastPage:!1,loading:!1,error:null,currentPage:1}),actions:{async getUserFollowersList(){if(!this.isLastPage){this.loading=!0;const e=this.currentPage;try{const r=await x(e,S);if(r)this.currentPage++,this.userFollowersList.push(...r),r.length<S&&(this.isLastPage=!0);else throw new Error}catch(r){this.error=r}finally{this.loading=!1}}}}});const _e={name:"following-list",props:["followersCount"],setup(){return{store:ae()}},mounted(){this.fetchMore()},methods:{fetchMore(){this.store.getUserFollowersList()},getShortenCountNumber(e){return C(e)},onFollowing(){console.log("onFollowing")}},computed:{isNoData(){var e;return!this.store.loading&&!((e=this.store.userReposList)!=null&&e.length)},isShowMore(){return!this.store.isLastPage&&!this.store.loading}}},ue=e=>(L("data-v-32d1e74c"),e=e(),b(),e),de={class:"following"},he={class:"title-wrapper"},ge=ue(()=>s("div",{class:"title"},"Following",-1)),fe={class:"title-value"},pe={key:0,class:"following__list"},me={class:"following__item-info"},we=["src","alt"],ve={class:"following__item-name-wrapper"},ye={class:"following__item-login"},Ce={class:"following__item-name"};function Le(e,r,t,l,h,n){return o(),i("div",de,[s("div",he,[ge,s("div",fe,_(t.followersCount),1)]),l.store.userFollowersList?(o(),i("ul",pe,[(o(!0),i(w,null,N(l.store.userFollowersList,a=>(o(),i("li",{key:a,class:"following__item"},[s("div",me,[s("img",{src:a.avatarUrl,alt:a.login,class:"following__item-img"},null,8,we),s("div",ve,[s("div",ye,_(a.login),1),s("div",Ce,_(a.name),1)])]),s("button",{type:"button",class:"btn following__item-btn",onClick:r[0]||(r[0]=(...g)=>n.onFollowing&&n.onFollowing(...g))}," following ")]))),128))])):c("",!0)])}const be=v(_e,[["render",Le],["__scopeId","data-v-32d1e74c"]]);const ke={name:"lk-page",components:{CLoader:$,FollowingList:be,UserInfo:ce,RepositoriesList:G},data(){return{contentName:void 0}},setup(){return{store:M()}},mounted(){this.setActiveContent()},methods:{setActiveContent(){const e=this.$route.query.content;e?this.contentName=e:this.changeContentActive(m.Repositories)},changeContentActive(e){this.$router.push({query:{content:e}}),this.contentName=e}},computed:{isShowRepositoriesList(){return this.contentName===m.Repositories},isShowFollowingList(){return this.contentName===m.Following}}},Fe={key:0,class:"lk"},Se={class:"lk__page-content page-content"},Re={class:"lk__user-info"},Ne={class:"lk__content-wrapper"};function Pe(e,r,t,l,h,n){var u;const a=d("user-info"),g=d("repositories-list"),y=d("following-list"),p=d("c-loader");return o(),i(w,null,[l.store.user?(o(),i("div",Fe,[s("div",Se,[s("div",Re,[P(a,{user:l.store.user,onChangeContentActive:n.changeContentActive},null,8,["user","onChangeContentActive"])]),s("div",Ne,[n.isShowRepositoriesList?(o(),f(g,{key:0,user:l.store.user},null,8,["user"])):c("",!0),n.isShowFollowingList?(o(),f(y,{key:1,followersCount:(u=l.store.user)==null?void 0:u.followers},null,8,["followersCount"])):c("",!0)])])])):c("",!0),l.store.user?c("",!0):(o(),f(p,{key:1,class:"loader-center-page"}))],64)}const Ie=v(ke,[["render",Pe],["__scopeId","data-v-f31789ae"]]);export{Ie as default};
